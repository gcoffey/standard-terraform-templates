resource:
  name: "aws_batch_compute_environment"
  enable_variable_comments: false
  var_name: "batch_compute_environment"
  required_vars:
    - name: "service_role"
      description: "The full ARN of the IAM role that allows AWS Batch to use other AWS services"
      type: "string"
    - name: "type"
      description: "The type of compute environment; MANAGED or UNMANAGED"
      type: "string"
  optional_vars:
    - name: "compute_environment_name"
      description: "The name for the compute environment"
      type: "string"
    - name: "compute_environment_name_prefix"
      description: "Creates a unique name using this prefix; don't use with compute_environment_name"
      type: "string"
    - name: "compute_resources"
      description: "Details of the compute resources managed by the compute environment"
      type: "block"
    - name: "eks_configuration"
      description: "Details for the EKS cluster that supports the compute environment"
      type: "block"
    - name: "state"
      description: "The state of the compute environment; ENABLED or DISABLED"
      default_value: "ENABLED"
      type: "string"
    - name: "tags"
      description: "Map of tags to assign to the bucket"
      type: "list"

blocks:
  - name: "compute_resources"
    description: "A compute resources block"
    required: false
    required_vars:
      - name: "max_vcpus"
        description: "The maximum number of EC2 vCPUs that an environment can have"
        type: "string"
      - name: "subnets"
        description: "A list of VPC subnets that compute resources are launched"
        type: "list"
      - name: "type"
        description: "The type of compute environment; EC2, SPOT, FARGATE or FARGATE_SPOT"
        type: "string"
    optional_vars:
      - name: "allocation_strategy"
        description: "The allocation strategy to use for the compute resource; BEST_FIT_PROGRESS, SPOT_CAPACITY_OPTIMIZED etc"
        default_value: "BEST_FIT"
        type: "string"
      - name: "bid_percentage"
        description: "Integer of maximum percentage that spot instance price can be when compared to on-demand"
        type: "string"
      - name: "desired_vcpus"
        description: "The desired number of EC2 vCPUs in the compute environment"
        type: "string"
      - name: "ec2_configuration"
        description: "Provides information used to select the AMI for EC2 instances"
        type: "block"
      - name: "ec2_key_pair"
        description: "The EC2 key pair that is used for instances launched in the compute environment"
        type: "string"
      - name: "image_id"
        description: "The AMI ID used for instances launch in the compute environment"
        type: "string"
      - name: "instance_role"
        description: "The Amazon ECS instance role applied to the EC2 instances in the compute environment"
        type: "string"
      - name: "instance_type"
        description: "A list of instance types that may be launched"
        type: "list"
      - name: "launch_template"
        description: "The launch template to use for your compute resources"
        type: "string"
      - name: "min_vcpus"
        description: "The minimum number of EC2 vCPUs that should be present in the compute environment"
        type: "string"
      - name: "placement_group"
        description: "The EC2 placement group to associated with your compute resources"
        type: "string"
      - name: "security_group_ids"
        description: "A list of EC2 security groups that are associated with instances launched in the environment"
        type: "list"
      - name: "spot_iam_fleet_role"
        description: "The ARN of the EC2 Spot Fleet IAM role"
        type: "string"
      - name: "tags"
        description: "Key-value pair tags to be applied to resources"
        type: "list"
  - name: "ec2_configuration"
    description: "An EC2 configration block"
    parent_block: "compute_resources"
    required: false
    optional_vars:
      - name: "image_id_override"
        description: "The AMI ID used for instances launched in the compute environment"
        type: "string"
      - name: "image_type"
        description: "The image type to match with the instance type to select an AMI?!"
        type: "string"
  - name: "launch_template"
    description: "A launch template block"
    parent_block: "compute_resources"
    required: false
    optional_vars:
      - name: "launch_template_id"
        description: "ID of the launch template"
        type: "string"
      - name: "launch_template_name"
        description: "Name of the launch template"
        type: "string"
      - name: "version"
        description: "The version number of the launch template"
        type: "string"
  - name: "eks_configuration"
    description: "An EKS configuration block"
    required: false
    required_vars:
      - name: "eks_cluster_arn"
        description: "The ARN of the Amazon EKS cluster"
        type: "string"
      - name: "kubernetes_namespace"
        description: "The namespace of the Amazon EKS cluster"
        type: "string"

