resource:
  name: "aws_lb"
  enable_variable_comments: false
  var_name: "lb"
  optional_vars:
    - name: "access_logs"
      description: "Access Logs Block"
      type: "block"
    - name: "customer_owned_ipv4_pool"
      description: "The ID of the customer owned ipv4 pool to use for this LB"
      type: "string"
    - name: "desync_mitigation_mode"
      description: "Determines how the LB handles requests that might pose a security risk; monitor, defensive or strictest"
      type: "string"
    - name: "drop_invalid_header_fields"
      description: "Indicates whether HTTP headers with header fields that are not valid are removed or routed to targets"
      type: "boolean"
    - name: "enable_cross_zone_load_balancing"
      description: "If true, cross-zone load balancing of the load balancer will be enabled; Default false"
      type: "boolean"
    - name: "enable_deletion_protection"
      description: "If true, deletion of the LB will be disabled via the AWS API; Default false"
      type: "boolean"
    - name: "enable_http2"
      description: "Indicates whether HTTP/2 is enabled in application laod balancers; Default true"
      type: "boolean"
    - name: "enable_tls_version_and_cipher_suite_headers"
      description: "Indicates whether the two header (x-amzn-tls-version and x-amzn-tls-cipher-suite) which contain info about TLS"
      type: "boolean"
    - name: "enable_xff_client_port"
      description: "Indicates whether the X-Forwarded-For header should preserve the source port that the client used; Default true"
      type: "boolean"
    - name: "enable_waf_fail_open"
      description: "Indicates whether to allow a WAF-enabled load balancer to route requests to targets if it is unable to forward to AWS WAF"
      type: "boolean"
    - name: "idle_timeout"
      description: "The time in seconds that the connection is allowed to be idle; Only valid for ALB; Default 60"
      type: "string"
    - name: "internal"
      description: "If true, the LB will be internal"
      type: "boolean"
    - name: "ip_address_type"
      description: "The type of IP addresses used by the subnets for your LB; ipv4 or dualstack"
      type: "string"
    - name: "load_balancer_type"
      description: "The type of LB to create; application, gateway or network"
      type: "string"
    - name: "name"
      description: "The name of the LB"
      type: "string"
    - name: "name_prefix"
      description: "Creates a unique name beginning with the specified prefix"
      type: "string"
    - name: "security_groups"
      description: "A list of security group IDs to assign to the LB"
      type: "list"
    - name: "preserve_host_header"
      description: "Indicates whether the ALB should preserve the Host header in the HTTP request; Default false"
      type: "boolean"
    - name: "subnet_mapping"
      description: "A subnet mapping block"
      type: "block"
    - name: "subnets"
      description: "A list of subnet IDs to attach to the LB"
      type: "list"
    - name: "xff_header_processing_mode"
      description: "Determines how the LB modifies the X-Forwarded-For header in the HTTP request; append, preserve or remove"
      type: "string"
    - name: "tags"
      description: "A map of tags to assign to the resource"
      type: "list"

blocks:
  - name: "access_logs"
    required: false
    description: "Access Logs Block"
    required_vars:
      - name: "bucket"
        description: "The S3 bucket name to store logs in"
        type: "string"
    optional_vars:
      - name: "enabled"
        description: "Boolean to enable / disable access_logs; Default false"
        type: "boolean"
      - name: "prefix"
        description: "The S3 bucket path prefix, Logs are stored in the root if not configured"
        type: "string"
  - name: "subnet_mapping"
    required: false
    description: "Subnet Mapping Block"
    required_vars:
      - name: "subnet_id"
        description: "ID of the subnet of which to attach to the LB"
        type: "string"
    optional_vars:
      - name: "allocation_id"
        description: "The allocation ID of the Elastic IP address for an internet facing LB"
        type: "string"
      - name: "ipv6_address"
        description: "The IPv6 address"
        type: "string"
      - name: "private_ipv4_address"
        description: "The private IPv4 address for an internal LB"
        type: "string"
