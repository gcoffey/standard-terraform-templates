resource:
  name: "azurerm_container_registry"
  enable_variable_comments: false
  var_name: "container_registry"
  required_vars:
    - name: "name"
      description: "Specifies the name of the Container Registry"
      type: "string"
    - name: "resource_group_name"
      description: "The name of the Resource group in which the Container Registry should be created"
      type: "string"
    - name: "location"
      description: "Specifies the supported Azure location where the resource should be created"
      type: "string"
    - name: "sku"
      description: "SKU name of the container registry; Basic, Standard or Premium"
      type: "string"
  optional_vars:
    - name: "admin_enabled"
      description: "Specifies whether the admin user is enabled; Default false"
      type: "boolean"
    - name: "georeplications"
      description: "Georeplications Block; Only supported when sku = Premium"
      type: "block"
    - name: "network_rule_set"
      description: "A network rule set block"
      type: "block"
    - name: "policy_network_access_enabled"
      description: "Whether public network access is allowed for the container registry; Default true"
      type: "boolean"
    - name: "quarantine_policy_enabled"
      description: "Boolean value that indicates whether quarantine policy is enabled"
      type: "boolean"
    - name: "retention_policy"
      description: "A retention policy block"
      type: "block"
    - name: "trust_policy"
      description: "A trust policy block"
      type: "block"
    - name: "zone_redundancy_enabled"
      description: "Whether zone redundancy is enabled for this container registry?; Default false"
      type: "boolean"
    - name: "export_policy_enabled"
      description: "Boolean value that indicates whether export policy is enabled; Default true"
      type: "boolean"
    - name: "identity"
      description: "An identity block"
      type: "block"
    - name: "encryption"
      description: "An encryption block"
      type: "block"
    - name: "anonymous_pull_enabled"
      description: "Whether allows anonymous pull access to this Container Registry?"
      type: "boolean"
    - name: "data_endpoint_enabled"
      description: "Whether to enable dedicated data endpoints for this container registry; only support when sku = Premium"
      type: "boolean"
    - name: "network_rule_bypass_option"
      description: "Whether to allow trusted Azure services to access a network restricted Container Registry; None or AzureServices"
      type: "string"
    - name: "tags"
      description: "A mapping of tags"
      type: "list"

blocks:
  - name: "georeplications"
    required: false
    description: "Geo Replications Block"
    required_vars:
      - name: "location"
        description: "A location where the container registry should be geo-replicated"
        type: "string"
    optional_vars:
      - name: "regional_endpoint_enabled"
        description: "Whether regional endpoint is enabled for this Container Registry"
        type: "boolean"
      - name: "zone_redundancy_enabled"
        description: "Whether zone redundancy is enabled for this replication location; Default false"
        type: "boolean"
      - name: "tags"
        description: "A mapping of tags"
        type: "list"
  - name: "network_rule_set"
    required: false
    description: "Network Rule Set Block; Only supported when sku = Premium"
    optional_vars:
      - name: "default_action"
        description: "The behaviour for requests matching no rules; Allow or Deny; Default Allow"
        type: "string"
      - name: "ip_rule"
        description: "One or more IP Rule blocks"
        type: "block"
      - name: "virtual_network"
        description: "One or more virtual network blocks"
        type: "block"
  - name: "ip_rule"
    required: false
    parent_block: "network_rule_set"
    description: "IP Rule Block"
    required_vars:
      - name: "action"
        description: "The behaviour for requests matching this rule; Allow"
        type: "string"
      - name: "ip_range"
        description: "The CIDR block from which requests will match the rule"
        type: "string"
  - name: "virtual_network"
    required: false
    parent_block: "network_rule_set"
    description: "Virtual Network Block"
    required_vars:
      - name: "action"
        description: "Behaviour for requests matching this rule; Allow"
        type: "string"
      - name: "subnet_id"
        description: "The subnet id from which requests will match the rule"
        type: "string"
  - name: "trust_policy"
    required: false
    description: "Trust Policy Block"
    optional_vars:
      - name: "enabled"
        description: "Boolean value that indicates whether the policy is enabled"
        type: "boolean"
  - name: "retention_policy"
    required: false
    description: "Retention Policy Block"
    optional_vars:
      - name: "days"
        description: "The number of days to retain an untagged manifest after which it gets purged; Default 7"
        type: "string"
      - name: "enabled"
        description: "Should the policy be enabled"
        type: "boolean"
  - name: "identity"
    required: false
    description: "Identity Block"
    required_vars:
      - name: "type"
        description: "Specifies the type of Managed Service IDentity; SystemAssigned, UserAssigned"
        type: "string"
    optional_vars:
      - name: "identity_ids"
        description: "Specifies a list of User Assigned Managed Identity Ids"
        type: "string"
  - name: "encryption"
    required: false
    description: "Encryption Block"
    required_vars:
      - name: "key_vault_key_id"
        description: "The ID of the Key Vault Key"
        type: "string"
      - name: "identity_client_id"
        description: "The Client ID of the managed Identity associated with the encryption key"
        type: "string"
    optional_vars:
      - name: "enabled"
        description: "Whether encryption is enabled"
        type: "boolean"
