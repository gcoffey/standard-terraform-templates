resource:
  name: "azurerm_linux_virtual_machine_scale_set"
  enable_variable_comments: false
  var_name: "linux_virtual_machine_scale_set"
  required_vars:
    - name: "name"
      description: "The name of the Linux Virtual MAchine Scale Set"
      type: "string"
    - name: "location"
      description: "Specifies the supported Azure location where the resource should be created"
      type: "string"
    - name: "resource_group_name"
      description: "The name of the Resource Group in which the Linux VM Scale Set should exist"
      type: "string"
    - name: "admin_username"
      description: "The username of the local administrator on each VM Scale Set instance"
      type: "string"
    - name: "instances"
      description: "The number of VMs in the Scale Set"
      type: "string"
    - name: "sku"
      description: "The VM SKU for the Scale Set, such as Standard_F2"
      type: "string"
    - name: "network_interface"
      description: "One or more network interface blocks"
      type: "block"
    - name: "os_disk"
      description: "An os disk block"
      type: "block"
  optional_vars:
    - name: "admin_password"
      description: "The password which should be used for the local administrator on this VM"
      type: "string"
    - name: "additional_capabilities"
      description: "An additional capabilities block"
      type: "block"
    - name: "admin_ssh_key"
      description: "One or more Admin SSH Key blocks"
      type: "block"
    - name: "automatic_os_upgrade_policy"
      description: "An automatic os upgrade policy block; only specify when upgrade_mode = Automatic or Rolling"
      type: "block"
    - name: "automatic_instance_repair"
      description: "An automatic instance repair block"
      type: "block"
    - name: "boot_diagnostics"
      description: "A boot diagnostics block"
      type: "block"
    - name: "capacity_reservation_group_id"
      description: "Specifies the ID of the Capacity Reservation Group which the VM Scale Set should be allocated to"
      type: "string"
    - name: "computer_name_prefix"
      description: "The prefix which should be used for the name of the VMs in this Scale Set"
      type: "string"
    - name: "custom_data"
      description: "The Base64-Encoded Custom Data which should be used for this VM Scale Set"
      type: "string"
    - name: "data_disk"
      description: "One or more data disk blocks"
      type: "block"
    - name: "disable_password_authentication"
      description: "Should Password Auth be disabled on this VM Scale Set; Default true"
      type: "boolean"
    - name: "do_not_run_extensions_on_overprovisioned_machines"
      description: "Should VM extensions be run on overprovisioned VMs in the Scale Set; Default false"
      type: "boolean"
    - name: "edge_zone"
      description: "Specifies the Edge Zone within the Azure Region where this VM Scale Set should exist"
      type: "string"
    - name: "encryption_at_host_enabled"
      description: "Should all of the disks attached to this VM be encrypted"
      type: "boolean"
    - name: "extension"
      description: "One or more extension blocks"
      type: "block"
    - name: "extension_operations_enabled"
      description: "Should extension operations be allowed on the VM Scale Set; Default true"
      type: "boolean"
    - name: "extensions_time_budget"
      description: "Specifies the duration allocated for all extensions to start; between 15 and 120 mins; Default PT1H30M [90mins]"
      type: "string"
    - name: "eviction_policy"
      description: "Specifies the eviction policy for VMs in this Scale Set; Deallocate or Delete"
      type: "string"
    - name: "gallery_application"
      description: "A Gallery Application Block"
      type: "string"
    - name: "health_probe_id"
      description: "The ID of a Load Balancer Probe which should be used to determine the health of an instance"
      type: "string"
    - name: "host_group_id"
      description: "Specifies the ID of the dedicated host group that the vm scale set resides in"
      type: "string"
    - name: "identity"
      description: "An identity block"
      type: "block"
    - name: "max_bid_price"
      description: "The maximum price you're willing to pay for each VM Scale Set in US dollars; Default -1"
      type: "string"
    - name: "overprovision"
      description: "Should Azure over-provision VMs in this Scale Set; Default true"
      type: "boolean"
    - name: "plan"
      description: "A plan block"
      type: "block"
    - name: "platform_fault_domain_count"
      description: "Specifies the number of fault domains that are used by the VM Scale Set"
      type: "string"
    - name: "priority"
      description: "The Priority of this VM Scale Set; Regular or Spot; Default Regular"
      type: "string"
    - name: "provision_vm_agent"
      description: "Should the Azure VM Agent be provisioned on each VM in the Scale Set; Default true"
      type: "boolean"
    - name: "proximity_placement_group_id"
      description: "The ID of the Proximity Placement Group in which the VM Scale Set"
      type: "string"
    - name: "rolling_upgrade_policy"
      description: "A rolling upgrade policy block; Require when upgrade_mode = Automatic or Rolling"
      type: "block"
    - name: "scale_in"
      description: "A Scale In Block"
      type: "string"
    - name: "secret"
      description: "One or more secret blocks"
      type: "block"
    - name: "secure_boot_enabled"
      description: "Specifies if Secure Boot and Trusted Launch is enabled for the VM"
      type: "boolean"
    - name: "single_placement_group"
      description: "Should this VM Scale Set be limited to a Single Placement Group; Default true"
      type: "boolean"
    - name: "source_image_id"
      description: "The ID of an image which each VM in this Scale Set"
      type: "string"
    - name: "source_image_reference"
      description: "A source image reference block"
      type: "block"
    - name: "spot_restore"
      description: "A spot restore block"
      type: "block"
    - name: "terminate_notification"
      description: "Terminate Notification Block"
      type: "block"
    - name: "tags"
      description: "A mapping of tags"
      type: "list"
    - name: "termination_notification"
      description: "Termination Notification Block"
      type: "block"
    - name: "upgrade_mode"
      description: "Specifies how Upgrades should be performed to VM instances; Automatic, Manual or Rolling"
      type: "string"
    - name: "user_data"
      description: "The Base64-Encoded User Data which should be used for this VM Scale Set"
      type: "string"
    - name: "vtpm_enabled"
      description: "Specifies if vTPM and Trusted Launch is enabled for the VM"
      type: "boolean"
    - name: "zone_balance"
      description: "Should the VMs in this Scale Set be evenly distributed across Availability Zones; Default false"
      type: "string"
    - name: "zones"
      description: "Specifies a list of Availability Zones in which this VM Scale Set should be located"
      type: "string"

blocks:
  - name: "additional_capabilities"
    required: false 
    description: "An Additional Capabilities Block"
    optional_vars:
      - name: "ultra_ssd_enabled"
        description: "Should the capacity to enable Data Disks of the UltraSSD_LRS storate account be supported; Default false"
        type: "boolean"
  - name: "admin_ssh_key"
    required: false
    description: "An Admin SSH Key Block"
    required_vars:
      - name: "public_key"
        description: "The Public Key which should be used for authentication, must be at least 2048-bit and in ssh-rsa format"
        type: "string"
      - name: "username"
        description: "The Username for which this Public SSH Key should be configured"
        type: "string"
  - name: "automatic_os_upgrade_policy"
    required: false
    description: "An Automatic OS Upgrade Policy Block"
    required_vars:
      - name: "disable_automatic_rollback"
        description: "Should automatic rollbacks be disabled"
        type: "boolean"
      - name: "enable_automatic_os_upgrade"
        description: "Should OS Upgrades automatically be applied to Scale Set instances in a rolling fashion"
        type: "string"
  - name: "automatic_instance_repair"
    required: false
    description: "An Automatic Instance Repair Block"
    required_vars:
      - name: "enabled"
        description: "Should the automatic instance repair be enabled on this Virtual Machine Scale Set"
        type: "boolean"
    optional_vars:
      - name: "grace_period"
        description: "Amount of time (in minutes, between 30 & 90; default PT30M) for which automatic repairs will be delayed"
        type: "string"
  - name: "boot_diagnostics"
    required: false
    description: "A Boot Diagnostics Block"
    optional_vars:
      - name: "storage_account_uri"
        description: "The primary / secondary endpoint for the Azure Storage Account which should be used for Boot Diagnostics"
        type: "string"
  - name: "certificate"
    required: false
    parent_block: "secret"
    description: "A Certificate Block"
    required_vars:
      - name: "url"
        description: "The Secret URL of a Key Vault Certificate"
        type: "string"
  - name: "data_disk"
    required: false
    description: "A Data Disk Block"
    required_vars:
      - name: "name"
        description: "The Name of the data disk"
        type: "string"
      - name: "caching"
        description: "The type of Caching which should be used; None, ReadOnly or ReadWrite"
        type: "string"
      - name: "disk_size_gb"
        description: "The size of the Data Disk which should be created"
        type: "string"
      - name: "lun"
        description: "The Logical Unit Number of the Data Disk"
        type: "string"
      - name: "storage_account_type"
        description: "The Type of STorage Account which should back this Data Disk; Standard_LRS, StandardSSD_LRS, Premium_LRS etc"
        type: "string"
    optional_vars:
      - name: "create_option"
        description: "The create option which should be used for this Data Disk; Empty or FromImage; Default Empty"
        type: "string"
      - name: "disk_encryption_set_id"
        description: "The ID of the Disk Encryption Set which should be used to encrypt this Data Disk"
        type: "string"
      - name: "ultra_ssd_disk_iops_read_write"
        description: "Specifies the Read-Write IOPS for this Data Disk"
        type: "string"
      - name: "ultra_ssd_disk_mbps_read_write"
        description: "Specifies the bandwidth in MB per second for this Data Disk"
        type: "string"
      - name: "write_accelerator_enabled"
        description: "write_accelerator_enabled; Default false"
        type: "boolean"
  - name: "diff_disk_settings"
    required: false
    parent_block: "os_disk"
    description: "A Diif Disk Settings Block"
    required_vars:
      - name: "option"
        description: "Specifies the Ephemeral Disk Settings for the OS Disk; Possible value is Local"
        type: "string"
    optional_vars:
      - name: "placement"
        description: "Specifies where to store the Ephemeral Disk; CacheDisk or ResourceDisk; Default CacheDisk"
        type: "string"
  - name: "extension"
    required: false
    description: "An Extension Block"
    required_vars:
      - name: "name"
        description: "The name for the Virtual Machine Scale Set extension"
        type: "string"
      - name: "publisher"
        description: "Specifies the Publisher of the Extension"
        type: "string"
      - name: "type"
        description: "Specifies the Type of the Extension"
        type: "string"
      - name: "type_handler_version"
        description: "Specifies the version of the extension to use"
        type: "string"
    optional_vars:
      - name: "auto_upgrade_minor_version"
        description: "Should the latest version of the Extension be used at Deployment Time; Default true"
        type: "boolean"
      - name: "automatic_upgrade_enabled"
        description: "Should the Extension be automatically updated whenever the Publisher releases a new version"
        type: "boolean"
      - name: "force_update_tag"
        description: "A value which, when different to the previous value can be used to force-run the Extension"
        type: "string"
      - name: "protected_settings"
        description: "A JSON String which specifies Sensitive Settings for the Extension"
        type: "string"
      - name: "protected_settings_from_key_vault"
        description: "A Protected Settings From Key Vault Block"
        type: "block"
      - name: "provision_after_extensions"
        description: "An ordered list of Extension names which this should be provisioned after"
        type: "string"
      - name: "settings"
        description: "A JSON String which specifies Settings for the Extension"
        type: "string"
  - name: "gallery_application"
    required: false
    description: "A Gallery Application Block"
    required_vars:
      - name: "version_id"
        description: "Specifies the Gallery Application Version resource ID"
        type: "string"
    optional_vars:
      - name: "configuration_blob_uri"
        description: "Specifies the URI to an Azure Blob that will replace the default configuration for the package if provided"
        type: "string"
      - name: "order"
        description: "Specifies the order in which the packages have to be installed"
        type: "string"
      - name: "tag"
        description: "Specifies a passthrough value for more generic context"
        type: "string"
  - name: "identity"
    required: false
    description: "An Identity Block"
    required_vars:
      - name: "type"
        description: "Specifies the type of Managed Service Identity; SystemAssigned or UserAssigned"
        type: "string"
    optional_vars:
      - name: "identity_ids"
        description: "Specifies a list of User Assigned Managed Identity IDs to be assigned to this Windows Virtual Machine Scale Set"
        type: "string"
  - name: "ip_configuration"
    required: false
    parent_block: "network_interface"
    description: "An IP Configuration Block"
    required_vars:
      - name: "name"
        description: "The name which should be used for this IP Configuration"
        type: "string"
    optional_vars:
      - name: "application_gateway_backend_address_pool_ids"
        description: "A list of Backend Address Pools from an App Gateway this Scale Set should attach to"
        type: "string"
      - name: "application_security_group_ids"
        description: "A list of Application Security Group IDs which this Scale Set should attach to"
        type: "string"
      - name: "load_balancer_backend_address_pool_ids"
        description: "A list of Backend Address Pools from a LB which this Scale Set should attach to"
        type: "string"
      - name: "load_balancer_inbound_nat_rules_ids"
        description: "A list of NAT Rule IDs from a Load Balancer which this Scale Set should attach to"
        type: "string"
      - name: "primary"
        description: "Is this the Primary IP Config for this Network Interface; Default false"
        type: "boolean"
      - name: "public_ip_address"
        description: "A Public IP Address Block"
        type: "block"
      - name: "subnet_id"
        description: "The ID of the Subnet which this IP Config should connect to"
        type: "string"
      - name: "version"
        description: "The Internet Protocol Version which should be used for this IP Config; IPv4 or IPv6; Default IPv4"
        type: "string"
  - name: "ip_tag"
    required: false
    parent_block: "public_ip_address"
    description: "An IP Tag Block"
    required_vars:
      - name: "tag"
        description: "The IP Tag associated with the Public IP, such as SQL or Storage"
        type: "string"
      - name: "type"
        description: "The Type of IP Tag such as FirstPartUsage"
        type: "string"
  - name: "network_interface"
    required: false
    description: "A Network Interface Block"
    required_vars:
      - name: "name"
        description: "The name which should be used for this network interface"
        type: "string"
      - name: "ip_configuration"
        description: "One or more ip_configuration blocks"
        type: "block"
    optional_vars:
      - name: "dns_servers"
        description: "A list of IP Addresses of DNS Servers which should be assigned to the network interface"
        type: "string"
      - name: "enable_accelerated_networking"
        description: "Does this Network interface support accelerated networking; Default false"
        type: "boolean"
      - name: "enable_ip_forwarding"
        description: "Does this Network interface support IP Forwarding; Default false"
        type: "boolean"
      - name: "network_security_group_id"
        description: "The ID of a Network Security Group which should be assigned to this Network Interface"
        type: "string"
      - name: "primary"
        description: "Is this the primary ip configuration"
        type: "string"
  - name: "os_disk"
    required: false
    description: "An OS Disk Block"
    required_vars:
      - name: "caching"
        description: "The Type of Caching which should be used for the Internal OS Disk; None, ReadOnly or ReadWrite"
        type: "string"
      - name: "storage_account_type"
        description: "The Type of Storage Account which should back this internal OS disk; Standard_LRS, StandardSSD_LRS etc"
        type: "string"
    optional_vars:
      - name: "diff_disk_settings"
        description: "A Diff Disk Settings block"
        type: "block"
      - name: "disk_encryption_set_id"
        description: "The ID of the Disk Encryption Set which should be used to encrypt this OS Disk"
        type: "string"
      - name: "disk_size_gb"
        description: "The size of the internal OS Disk in GB"
        type: "string"
      - name: "secure_vm_disk_encryption_set_id"
        description: "The ID of the Disk Encryption Set which should be used to encrypt this OS Disk. Required when Confidential VMSS"
        type: "string"
      - name: "security_encryption_type"
        description: "Encryption Type when the Virtual Machine Scale Set is Confidential VMSS; VMGuestStateOnly or DiskWithVMGuestState"
        type: "string"
      - name: "write_accelerator_enabled"
        description: "Should Write Accelerator be Enabled for this OS Disk; Default false"
        type: "boolean"
  - name: "plan"
    required: false
    description: "A Plan Block"
    required_vars:
      - name: "name"
        description: "Specifies the name of the image from the marketplace"
        type: "string"
      - name: "publisher"
        description: "Specifies the publisher of the image"
        type: "string"
      - name: "product"
        description: "Specifies the product of the image from the marketplace"
        type: "string"
  - name: "scale_in"
    required: false
    description: "A Scale In Block"
    optional_vars:
      - name: "rule"
        description: "The scale-in policy rule that decides which VMs are chosen for removal; Default, NewestVM or OldestVM; Default is Default"
        type: "string"
      - name: "force_deletion_enabled"
        description: "Should the VMs chosen for removal be force deleted when the VMSS is being scaled in; Default false"
        type: "boolean"
  - name: "protected_settings_from_key_vault"
    required: false
    parent_block: "extension"
    description: "A Protected Settings from Key Vault Block"
    required_vars:
      - name: "secret_url"
        description: "The URL to the Key Vault Secret which stores the protected Settings"
        type: "string"
      - name: "source_vault_id"
        description: "The ID of the source Key Vault"
        type: "string"
  - name: "public_ip_address"
    required: false
    parent_block: "ip_configuration"
    description: "A Public IP Address Block"
    required_vars:
      - name: "name"
        description: "The name of the Public IP Address configuration"
        type: "string"
    optional_vars:
      - name: "domain_name_label"
        description: "The Prefix which should be used for the Domain Name Label for each VM"
        type: "string"
      - name: "idle_timeout_in_minutes"
        description: "The Idle Timeout in Minutes for the Public IP Address; Between 4 and 32"
        type: "string"
      - name: "ip_tag"
        description: "One or more ip_tag blocks"
        type: "block"
      - name: "public_ip_prefix_id"
        description: "The ID of the Public IP Address Prefix from where Public IP Addresses should be allocated"
        type: "string"
      - name: "version"
        description: "The Internet Protocol Version which should be used for this Public IP Address; IPv4 or IPv6; Default IPv4"
        type: "string"
  - name: "rolling_upgrade_policy"
    required: false
    description: "A Rolling Upgrade Policy Block"
    required_vars:
      - name: "max_batch_instance_percent"
        description: "The maximum percent of total VM instances that will be upgraded simultaneously"
        type: "string"
      - name: "max_unhealthy_instance_percent"
        description: "The maximum percent of total VM instances that can be unhealthy, before the update aborts"
        type: "string"
      - name: "max_unhealthy_upgraded_instance_percent"
        description: "The maximum percent of upgraded VM instances that can be found to be unhealthy"
        type: "string"
      - name: "pause_time_between_batches"
        description: "The wait time between completing the update for all VM in one batch and starting the next batch; Time duration in ISO8601 format"
        type: "string"
    optional_vars:
      - name: "cross_zone_upgrades_enabled"
        description: "Should the VM Scale SEt ignore the Azure Zone boundaries when constructing upgrade batches; true or false"
        type: "boolean"
      - name: "prioritize_unhealth_instances_enabled"
        description: "Upgrade all unhealthy instances in a scale set before any health instances; true or false"
        type: "boolean"
  - name: "secret"
    required: false
    description: "A Secret Block"
    required_vars:
      - name: "certificate"
        description: "One or more certificate blocks"
        type: "block"
      - name: "key_vault_id"
        description: "The ID of the Key Vault which all Secrets should be sourced"
        type: "string"
  - name: "terminate_notification"
    required: false
    description: "A Terminate Notification Block"
    required_vars:
      - name: "enabled"
        description: "Should the terminate notification be enabled on this VM Scale Set"
        type: "boolean"
    optional_vars:
      - name: "timeout"
        description: "Length of time (in minutes, between 5 and 15) a notification to be sent to the VM; Default PT5M"
        type: "string"
  - name: "termination_notification"
    required: false
    description: "A Termination Notification Block"
    required_vars:
      - name: "enabled"
        description: "Should the termination notification be enabled on this VM Scale Set"
        type: "boolean"
    optional_vars:
      - name: "timeout"
        description: "Length of time (in minutes, between 5 and 15) a notification to be sent to the VM; Default PT5M"
        type: "string"
  - name: "source_image_reference"
    required: false
    description: "A Source Image Reference Block"
    required_vars:
      - name: "publisher"
        description: "Specifies the publisher of the image used to create the virtual machines"
        type: "string"
      - name: "offer"
        description: "Specifies the offer of the image used to create the virtual machines"
        type: "string"
      - name: "sku"
        description: "Specifies the SKU of the image used to create the virtual machines"
        type: "string"
      - name: "version"
        description: "Specifies the version of the image used to create the virtual machines"
        type: "string"
  - name: "spot_restore"
    required: false
    description: "A Spot Restore Block"
    optional_vars:
      - name: "enabled"
        description: "Should the Spot-Try-Restore feature be enabled"
        type: "boolean"
      - name: "timeout"
        description: "The length of time that the VM Scale SEt should attempt to restore the Spot VM instances; Default PT1H30M"
        type: "string"
