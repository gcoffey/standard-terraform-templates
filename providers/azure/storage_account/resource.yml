resource:
  name: "azurerm_storage_account"
  enable_variable_comments: false
  var_name: "storage_account"
  required_vars:
    - name: "name"
      description: "The name of the storage account"
      type: "string"
    - name: "resource_group_name"
      description: "The name of the resource group to create the storage account in"
      type: "string"
    - name: "location"
      description: "The Azure location to create the storage account"
      type: "string"
    - name: "account_tier"
      description: "Defines the Tier to use for this storage account; Standard or Premium"
      type: "string"
    - name: "account_replication_type"
      description: "Defines the type of replication to use; LRS, GRS, RAGRS, ZRS, GZRS or RAGZRS"
      type: "string"
  optional_vars:
    - name: "account_kind"
      description: "Defines te Kind of account; BlobStorage, BlockBlobStorage, FileStorage, Storage, StorageV2"
      default_value: "StorageV2"
      type: "string"
    - name: "cross_tenant_replication_enabled"
      description: "Should cross Tenant replication be enabled; Default is true"
      default_value: true
      type: "boolean"
    - name: "access_tier"
      description: "Defines the access tier for BlobStorage, FileStorage and StorageV2 accounts; Hot or Cool"
      default_value: "Hot"
      type: "string"
    - name: "edge_zone"
      description: "Specifies the Edge Zone within the Azure Region where this Storage account should exist"
      type: "string"
    - name: "enable_https_traffic_only"
      description: "Force HTTPS only; default true"
      default_value: true
      type: "boolean"
    - name: "min_tls_version"
      description: "Minimum supported TLS version; TLS1_0, TLS1_1 or TLS1_2"
      default_value: "TLS1_2"
      type: "string"
    - name: "allow_nested_items_to_be_public"
      description: "Allow or disallow nested items within the Account to be public"
      default_value: true
      type: "boolean"
    - name: "shared_access_key_enabled"
      description: "Indicates whether the storage account permits requests to be authorized via Shared Key"
      default_value: true
      type: "boolean"
    - name: "public_network_access_enabled"
      description: "Whether the public network access is enabled?!"
      default_value: true
      type: "boolean"
    - name: "default_to_oauth_authentication"
      description: "Default to Azure Active directory authorization in the Azure Portal"
      default_value: false
      type: "boolean"
    - name: "is_hns_enabled"
      description: "Is hierarchical namespace enabled?!"
      type: "boolean"
    - name: "nfsv3_enabled"
      description: "Is NFSv3 protocol enabled; Default false"
      default_value: false
      type: "boolean"
    - name: "custom_domain"
      description: "A custom domain block"
      type: "block"
    - name: "customer_managed_key"
      description: "A customer managed key block"
      type: "block"
    - name: "identity"
      description: "An identity block"
      type: "block"
    - name: "blob_properties"
      description: "A blob properties block"
      type: "block"
    - name: "queue_properties"
      description: "A queue properties block"
      type: "block"
    - name: "static_website"
      description: "A static website block"
      type: "block"
    - name: "share_properties"
      description: "A Share properties block"
      type: "block"
    - name: "network_rules"
      description: "A network rules block"
      type: "block"
    - name: "large_file_share_enabled"
      description: "Is Large File Share enabled?"
      type: "boolean"
    - name: "azure_files_authentication"
      description: "An azure files authentication block"
      type: "block"
    - name: "routing"
      description: "A routing block"
      type: "block"
    - name: "queue_encryption_key_type"
      description: "The encryption type of the queue services; Service or Account"
      default_value: "Service"
      type: "string"
    - name: "table_encryption_key_type"
      description: "The encryption type of the table service; Service or Account"
      default_value: "Service"
      type: "string"
    - name: "infrastructure_encryption_enabled"
      description: "Is infrastructure encryption enabled?!"
      default_value: false
      type: "boolean"
    - name: "immutability_policy"
      description: "An immutability policy block"
      type: "block"
    - name: "sas_policy"
      description: "A SAS Policy block"
      type: "block"
    - name: "allowed_copy_scope"
      description: "Restrict copy to and from Storage Account within AAD tenant or Private Links; AAD or PrivateLink"
      type: "string"
    - name: "sftp_enabled"
      description: "Enable SFTP for the Storage Account"
      type: "boolean"
    - name: "tags"
      description: "A mapping of tags to assign to this storage account"
      type: "list"

blocks:
  - name: "blob_properties"
    description: "An Blob Properties block"
    required: false
    optional_vars:
      - name: "cors_rule"
        description: "A CORS Rule Block"
        type: "block"
      - name: "delete_retention_policy"
        description: "A delete retention policy block"
        type: "block"
      - name: "restore_policy"
        description: "A restore policy block"
        type: "block"
      - name: "versioning_enabled"
        description: "Is versioning enabled?"
        default_value: false
        type: "boolean"
      - name: "change_feed_enabled"
        description: "Is the blob service properties change feed events enabled?"
        default_value: false
        type: "boolean"
      - name: "change_feed_retention_in_days"
        description: "The duration of change feed events retention in days; between 1 and 146000 days"
        type: "string"
      - name: "default_service_version"
        description: "The API version which should be used by default for requests to the data Plane API"
        type: "string"
      - name: "last_access_time_enabled"
        description: "Is the last access time based tracking enabled?"
        default_value: false
        type: "boolean"
      - name: "container_delete_retention_policy"
        description: "A container delete retention policy block"
        type: "block"
  - name: "cors_rule"
    description: "A CORS rule block"
    parent_block: "blob_properties"
    required: false
    required_vars:
      - name: "allowed_headers"
        description: "A list of headers that are allowed to be a part of the cross-origin request"
        type: "list"
      - name: "allowed_methods"
        description: "A list of allowed HTTP methods; DELETE, GET, HEAD, MERGE, POST, OPTIONS, PUT or PATCH"
        type: "list"
      - name: "allowed_origins"
        description: "A list of origin domains that will be allowed by CORS"
        type: "list"
      - name: "exposed_headers"
        description: "A list of response headers that are exposed to CORS clients"
        type: "list"
      - name: "max_age_in_seconds"
        description: "The number of seconds the client should cache a preflight response"
        type: "string"
  - name: "custom_domain"
    description: "A custom domain block"
    required: false
    required_vars:
      - name: "name"
        description: "The custom domain name to use for the storage account which will be validated by Azure"
        type: "string"
    optional_vars:
      - name: "use_subdomain"
        description: "Should the custom domain name be validated by using indirect cname validation?"
        type: "boolean"
  - name: "customer_managed_key"
    description: "A Customer Managed Key block"
    required: false
    required_vars:
      - name: "key_vault_key_id"
        description: "The ID of the Key Vault Key supplying a versionless key ID will enable auto rotation"
        type: "string"
      - name: "user_assigned_identity_id"
        description: "The ID of a user assigned identity"
        type: "string"
  - name: "delete_retention_policy"
    description: "A delete retention policy block"
    required: false
    optional_vars:
      - name: "days"
        description: "specifies the number of days that the blob should be retained; Default 7"
        default_value: "7"
        type: "string"
  - name: "restore_policy"
    description: "A restore policy block"
    required_vars:
      - name: "days"
        description: "specifies the number of days that the blob should be restored"
        type: "string"
  - name: "container_delete_retention_policy"
    description: "A container delete retention policy block"
    required: false
    optional_vars:
      - name: "days"
        description: "specifies the number of days that the blob should be retained; Default 7"
        default_value: "7"
        type: "string"
  - name: "hour_metrics"
    description: "An hour metrics block"
    parent_block: "queue_properties"
    required: false
    required_vars:
      - name: "enabled"
        description: "Indicates whether hour metrics are enabled for the Queue service"
        type: "boolean"
      - name: "version"
        description: "The version of storage analytics to configure"
        type: "string"
    optional_vars:
      - name: "include_apis"
        description: "Indicates whether metrics should generate summary stats for called API operations"
        type: "boolean"
      - name: "retention_policy_days"
        description: "Specifies the number of dayas that logs will be retained"
        type: "string"
  - name: "identity"
    description: "An Identity block"
    required: false
    required_vars:
      - name: "type"
        description: "Specifies the type of Managed SErvice Identity; SystemAssigned or UserAssigned"
        type: "string"
    optional_vars:
      - name: "identity_ids"
        description: "Specifies a list of User Assigned Managed Identity IDs"
        type: "string"
  - name: "immutability_policy"
    description: "An Immutability policy block"
    required: false
    required_vars:
      - name: "allow_protected_append_writes"
        description: "When enabled, new blocks can be written to an append blob"
        type: "boolean"
      - name: "state"
        description: "Defines the mode of the policy; Disabled, Unlockd or Locked"
        type: "string"
      - name: "period_since_creation_in_days"
        description: "The immutability period for the blobs in the container since the policy creation, in days"
        type: "string"
  - name: "logging"
    description: "A logging block"
    parent_block: "queue_properties"
    required: false
    required_vars:
      - name: "delete"
        description: "Indicates whether all delete requests should be logged"
        type: "boolean"
      - name: "read"
        description: "Indicates whether all read requests should be logged"
        type: "boolean"
      - name: "version"
        description: "The version of storage analtics to configure"
        type: "string"
      - name: "write"
        description: "Indicates whether all write requests should be logged"
        type: "string"
    optional_vars:
      - name: "retention_policy_days"
        description: "Specifies the number of days that logs will be retained"
        type: "string"
  - name: "minute_metrics"
    description: "A minute metrics block"
    parent_block: "queue_properties"
    required: false
    required_vars:
      - name: "enabled"
        description: "Indicates whether minute metrics are enabled for the queue service"
        type: "boolean"
      - name: "version"
        description: "The version of storage analytics to configure"
        type: "string"
    optional_vars:
      - name: "include_apis"
        description: "The version of storage analtics to configure"
        type: "string"
      - name: "retention_policy_days"
        description: "Specifies the number of days that logs will be retained"
        type: "string"
  - name: "network_rules"
    description: "A network rules block"
    required: false
    required_vars:
      - name: "default_action"
        description: "Specifies the default action of allow or deny; Deny or Allow"
        type: "string"
    optional_vars:
      - name: "bypass"
        description: "Specifies whether traffic is bypassed for logging; Logging, Metrics, AzureServices or None"
        type: "string"
      - name: "ip_rules"
        description: "List of public IP or IP ranges in CIDR format"
        type: "list"
      - name: "virtual_network_subnet_ids"
        description: "A list of resource ids for subnets"
        type: "string"
      - name: "private_link_access"
        description: "One or more private link access blocks"
        type: "block"
  - name: "private_link_access"
    description: "A private link access block"
    parent_block: "network_rules"
    required: false
    required_vars:
      - name: "endpoint_resource_id"
        description: "The resource id of the resource access rule to be granted access"
        type: "string"
    optional_vars:
      - name: "endpoint_tenant_id"
        description: "The tenant id of the resource of the resource access rule to be granted access"
        type: "string"
  - name: "azure_files_authentication"
    description: "An Azure files authentication block"
    required: false
    required_vars:
      - name: "directory_type"
        description: "Specifies the directory service used; AADDS, AD or AADKERB"
        type: "string"
    optional_vars:
      - name: "active_directory"
        description: "A active directory block; required when directory_type is AD"
        type: "block"
  - name: "active_directory"
    description: "An active directory block"
    parent_block: "azure_files_authentication"
    required: false
    required_vars:
      - name: "domain_name"
        description: "Specifies the primary domain that the AD DNS server is authoritative for"
        type: "string"
      - name: "domain_guid"
        description: "Specifies the domain GUID"
        type: "string"
    optional_vars:
      - name: "domain_sid"
        description: "Specifies the security identifier; required when directory_type is AD"
        type: "string"
      - name: "storage_sid"
        description: "Specifies the security identifier for Azuer Storage; required when directory_type is AD"
        type: "string"
      - name: "forest_name"
        description: "Specifies the Active Directory forest; required when directory_type is AD"
        type: "string"
      - name: "netbios_domain_name"
        description: "Specifies the NetBIOS domain name; required when directory_type is AD"
        type: "string"
  - name: "routing"
    description: "A routing block"
    required: false
    optional_vars:
      - name: "publish_internet_endpoints"
        description: "Should Internet routing storage endpoints be published?"
        default_value: false
        type: "boolean"
      - name: "publish_microsoft_endpoints"
        description: "Should microsoft routing storage endpoints be published?"
        default_value: false
        type: "boolean"
      - name: "choice"
        description: "Specifies the kind of network routing; InternetRouting or MicrosoftRouting"
        default_value: "MicrosoftRouting"
        type: "string"
  - name: "queue_properties"
    description: "A Queue properties block"
    required: false
    optional_vars:
      - name: "cors_rule"
        description: "A Cors rule block"
        type: "block"
      - name: "logging"
        description: "A Logging block"
        type: "block"
      - name: "minute_metrics"
        description: "A minute metrics block"
        type: "block"
      - name: "hour_metrics"
        description: "An hour metrics block"
        type: "block"
  - name: "sas_policy"
    description: "A SAS Policy block"
    required: false
    required_vars:
      - name: "expiration_period"
        description: "Expiration period in format of DD.HH:MM:SS"
        type: "string"
    optional_vars:
      - name: "expiration_action"
        description: "The SAS expiration action; Default is Log"
        default_value: "Log"
        type: "string"
  - name: "static_website"
    description: "A static website block"
    required: false
    optional_vars:
      - name: "index_document"
        description: "The webpage that Azure Storage serves for requests to the root of a folder"
        type: "string"
      - name: "error_404_document"
        description: "The absolute path to a custom webpage to display when a 404 error is encountered"
        type: "string"
  - name: "share_properties"
    description: "A Share properties block"
    required: false
    optional_vars:
      - name: "cors_rule"
        description: "A Cors rule block"
        type: "block"
      - name: "retention_policy"
        description: "A retention policy block"
        type: "block"
      - name: "smb"
        description: "An SMB block"
        type: "block"
  - name: "retention_policy"
    description: "A Retention Policy block"
    required: false
    parent_block: "share_properties"
    optional_vars:
      - name: "days"
        description: "Specifies the number of days that the share should be retained; Default 7"
        default_value: "7"
        type: "string"
  - name: "smb"
    description: "An SMB block"
    required: false
    parent_block: "share_properties"
    optional_vars:
      - name: "versions"
        description: "A set of SMB protocol versions; SMB2.1, SMB3.0 or SMB3.1.1"
        type: "string"
      - name: "authentication_types"
        description: "A set of SMB auth methods; NTLMv2 or Kerberos"
        type: "string"
      - name: "kerberos_ticket_encryption_type"
        description: "A set of Kerberos ticket encryption; RC4-HMAC or AES-256"
        type: "string"
      - name: "channel_encryption_type"
        description: "A set of SMB channel encryption; AES-128-CCM, AES-128-GCM or AES-256-GCM"
        type: "string"
      - name: "multichannel_enabled"
        description: "Indicates whether multichannel is enabled; Default false"
        default_value: false
        type: "boolean"

