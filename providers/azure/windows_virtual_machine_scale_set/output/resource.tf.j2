resource "azurerm_windows_virtual_machine_scale_set" "{{ windows_virtual_machine_scale_set.name }}" {
  ## Required Vars
  name   = "{{ windows_virtual_machine_scale_set.name }}"
  location   = "{{ windows_virtual_machine_scale_set.location }}"
  resource_group_name   = "{{ windows_virtual_machine_scale_set.resource_group_name }}"
  admin_password   = "{{ windows_virtual_machine_scale_set.admin_password }}"
  admin_username   = "{{ windows_virtual_machine_scale_set.admin_username }}"
  instances   = "{{ windows_virtual_machine_scale_set.instances }}"
  sku   = "{{ windows_virtual_machine_scale_set.sku }}"

  ## Optional Vars
  capacity_reservation_group_id   = "{{ windows_virtual_machine_scale_set.capacity_reservation_group_id }}"
  computer_name_prefix   = "{{ windows_virtual_machine_scale_set.computer_name_prefix }}"
  custom_data   = "{{ windows_virtual_machine_scale_set.custom_data }}"
  do_not_run_extensions_on_overprovisioned_machines   = {{ windows_virtual_machine_scale_set.do_not_run_extensions_on_overprovisioned_machines }}
  edge_zone   = "{{ windows_virtual_machine_scale_set.edge_zone }}"
  enable_automatic_updates   = {{ windows_virtual_machine_scale_set.enable_automatic_updates }}
  encryption_at_host_enabled   = {{ windows_virtual_machine_scale_set.encryption_at_host_enabled }}
  extension_operations_enabled   = {{ windows_virtual_machine_scale_set.extension_operations_enabled }}
  extensions_time_budget   = "{{ windows_virtual_machine_scale_set.extensions_time_budget }}"
  eviction_policy   = "{{ windows_virtual_machine_scale_set.eviction_policy }}"
  gallery_application   = "{{ windows_virtual_machine_scale_set.gallery_application }}"
  health_probe_id   = "{{ windows_virtual_machine_scale_set.health_probe_id }}"
  host_group_id   = "{{ windows_virtual_machine_scale_set.host_group_id }}"
  license_type   = "{{ windows_virtual_machine_scale_set.license_type }}"
  max_bid_price   = "{{ windows_virtual_machine_scale_set.max_bid_price }}"
  overprovision   = {{ windows_virtual_machine_scale_set.overprovision }}
  platform_fault_domain_count   = "{{ windows_virtual_machine_scale_set.platform_fault_domain_count }}"
  priority   = "{{ windows_virtual_machine_scale_set.priority }}"
  provision_vm_agent   = {{ windows_virtual_machine_scale_set.provision_vm_agent }}
  proximity_placement_group_id   = "{{ windows_virtual_machine_scale_set.proximity_placement_group_id }}"
  scale_in   = "{{ windows_virtual_machine_scale_set.scale_in }}"
  secure_boot_enabled   = {{ windows_virtual_machine_scale_set.secure_boot_enabled }}
  single_placement_group   = {{ windows_virtual_machine_scale_set.single_placement_group }}
  source_image_id   = "{{ windows_virtual_machine_scale_set.source_image_id }}"
  tags   = "{{ windows_virtual_machine_scale_set.tags | to_json | safe }}"
  timezone   = "{{ windows_virtual_machine_scale_set.timezone }}"
  upgrade_mode   = "{{ windows_virtual_machine_scale_set.upgrade_mode }}"
  user_data   = "{{ windows_virtual_machine_scale_set.user_data }}"
  vtpm_enabled   = {{ windows_virtual_machine_scale_set.vtpm_enabled }}
  zone_balance   = "{{ windows_virtual_machine_scale_set.zone_balance }}"
  zones   = "{{ windows_virtual_machine_scale_set.zones }}"

  ## Blocks
  additional_capabilities {
    ## Optional Block Vars
    ultra_ssd_enabled   = {{ windows_virtual_machine_scale_set.additional_capabilities.ultra_ssd_enabled }}
  }
  additional_unattend_content {
    ## Required Block Vars
    content   = "{{ windows_virtual_machine_scale_set.additional_unattend_content.content }}"
    setting   = "{{ windows_virtual_machine_scale_set.additional_unattend_content.setting }}"
  }
  automatic_os_upgrade_policy {
    ## Required Block Vars
    disable_automatic_rollback   = {{ windows_virtual_machine_scale_set.automatic_os_upgrade_policy.disable_automatic_rollback }}
    enable_automatic_os_upgrade   = "{{ windows_virtual_machine_scale_set.automatic_os_upgrade_policy.enable_automatic_os_upgrade }}"
  }
  automatic_instance_repair {
    ## Required Block Vars
    enabled   = {{ windows_virtual_machine_scale_set.automatic_instance_repair.enabled }}
    ## Optional Block Vars
    grace_period   = "{{ windows_virtual_machine_scale_set.automatic_instance_repair.grace_period }}"
  }
  boot_diagnostics {
    ## Optional Block Vars
    storage_account_uri   = "{{ windows_virtual_machine_scale_set.boot_diagnostics.storage_account_uri }}"
  }
  data_disk {
    ## Required Block Vars
    name   = "{{ windows_virtual_machine_scale_set.data_disk.name }}"
    caching   = "{{ windows_virtual_machine_scale_set.data_disk.caching }}"
    disk_size_gb   = "{{ windows_virtual_machine_scale_set.data_disk.disk_size_gb }}"
    lun   = "{{ windows_virtual_machine_scale_set.data_disk.lun }}"
    storage_account_type   = "{{ windows_virtual_machine_scale_set.data_disk.storage_account_type }}"
    ## Optional Block Vars
    create_option   = "{{ windows_virtual_machine_scale_set.data_disk.create_option }}"
    disk_encryption_set_id   = "{{ windows_virtual_machine_scale_set.data_disk.disk_encryption_set_id }}"
    ultra_ssd_disk_iops_read_write   = "{{ windows_virtual_machine_scale_set.data_disk.ultra_ssd_disk_iops_read_write }}"
    ultra_ssd_disk_mbps_read_write   = "{{ windows_virtual_machine_scale_set.data_disk.ultra_ssd_disk_mbps_read_write }}"
    write_accelerator_enabled   = {{ windows_virtual_machine_scale_set.data_disk.write_accelerator_enabled }}
  }
  extension {
    ## Required Block Vars
    name   = "{{ windows_virtual_machine_scale_set.extension.name }}"
    publisher   = "{{ windows_virtual_machine_scale_set.extension.publisher }}"
    type   = "{{ windows_virtual_machine_scale_set.extension.type }}"
    type_handler_version   = "{{ windows_virtual_machine_scale_set.extension.type_handler_version }}"
    ## Optional Block Vars
    auto_upgrade_minor_version   = {{ windows_virtual_machine_scale_set.extension.auto_upgrade_minor_version }}
    automatic_upgrade_enabled   = {{ windows_virtual_machine_scale_set.extension.automatic_upgrade_enabled }}
    force_update_tag   = "{{ windows_virtual_machine_scale_set.extension.force_update_tag }}"
    protected_settings   = "{{ windows_virtual_machine_scale_set.extension.protected_settings }}"
    protected_settings_from_key_vault {
      ## Required Block Vars
      secret_url   = "{{ windows_virtual_machine_scale_set.extension.protected_settings_from_key_vault.secret_url }}"
 
      source_vault_id   = "{{ windows_virtual_machine_scale_set.extension.protected_settings_from_key_vault.source_vault_id }}"
 
    }
    provision_after_extensions   = "{{ windows_virtual_machine_scale_set.extension.provision_after_extensions }}"
    settings   = "{{ windows_virtual_machine_scale_set.extension.settings }}"
  }
  gallery_application {
    ## Required Block Vars
    version_id   = "{{ windows_virtual_machine_scale_set.gallery_application.version_id }}"
    ## Optional Block Vars
    configuration_blob_uri   = "{{ windows_virtual_machine_scale_set.gallery_application.configuration_blob_uri }}"
    order   = "{{ windows_virtual_machine_scale_set.gallery_application.order }}"
    tag   = "{{ windows_virtual_machine_scale_set.gallery_application.tag }}"
  }
  identity {
    ## Required Block Vars
    type   = "{{ windows_virtual_machine_scale_set.identity.type }}"
    ## Optional Block Vars
    identity_ids   = "{{ windows_virtual_machine_scale_set.identity.identity_ids }}"
  }
  network_interface {
    ## Required Block Vars
    name   = "{{ windows_virtual_machine_scale_set.network_interface.name }}"
    ip_configuration {
      ## Required Block Vars
      name   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.name }}"
      ## Optional Block Vars
      application_gateway_backend_address_pool_ids   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.application_gateway_backend_address_pool_ids }}"
      application_security_group_ids   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.application_security_group_ids }}"
      load_balancer_backend_address_pool_ids   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.load_balancer_backend_address_pool_ids }}"
      load_balancer_inbound_nat_rules_ids   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.load_balancer_inbound_nat_rules_ids }}"
      primary   = {{ windows_virtual_machine_scale_set.network_interface.ip_configuration.primary }}
      subnet_id   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.subnet_id }}"
      version   = "{{ windows_virtual_machine_scale_set.network_interface.ip_configuration.version }}"
    }
    ## Optional Block Vars
    dns_servers   = "{{ windows_virtual_machine_scale_set.network_interface.dns_servers }}"
    enable_accelerated_networking   = {{ windows_virtual_machine_scale_set.network_interface.enable_accelerated_networking }}
    enable_ip_forwarding   = {{ windows_virtual_machine_scale_set.network_interface.enable_ip_forwarding }}
    network_security_group_id   = "{{ windows_virtual_machine_scale_set.network_interface.network_security_group_id }}"
    primary   = "{{ windows_virtual_machine_scale_set.network_interface.primary }}"
  }
  os_disk {
    ## Required Block Vars
    caching   = "{{ windows_virtual_machine_scale_set.os_disk.caching }}"
    storage_account_type   = "{{ windows_virtual_machine_scale_set.os_disk.storage_account_type }}"
    ## Optional Block Vars
    diff_disk_settings {
      ## Required Block Vars
      option   = "{{ windows_virtual_machine_scale_set.os_disk.diff_disk_settings.option }}"
 
      ## Optional Block Vars
      placement   = "{{ windows_virtual_machine_scale_set.os_disk.diff_disk_settings.placement }}"
    }
    disk_encryption_set_id   = "{{ windows_virtual_machine_scale_set.os_disk.disk_encryption_set_id }}"
    disk_size_gb   = "{{ windows_virtual_machine_scale_set.os_disk.disk_size_gb }}"
    secure_vm_disk_encryption_set_id   = "{{ windows_virtual_machine_scale_set.os_disk.secure_vm_disk_encryption_set_id }}"
    security_encryption_type   = "{{ windows_virtual_machine_scale_set.os_disk.security_encryption_type }}"
    write_accelerator_enabled   = {{ windows_virtual_machine_scale_set.os_disk.write_accelerator_enabled }}
  }
  plan {
    ## Required Block Vars
    name   = "{{ windows_virtual_machine_scale_set.plan.name }}"
    publisher   = "{{ windows_virtual_machine_scale_set.plan.publisher }}"
    product   = "{{ windows_virtual_machine_scale_set.plan.product }}"
  }
  scale_in {
    ## Optional Block Vars
    rule   = "{{ windows_virtual_machine_scale_set.scale_in.rule }}"
    force_deletion_enabled   = {{ windows_virtual_machine_scale_set.scale_in.force_deletion_enabled }}
  }
  rolling_upgrade_policy {
    ## Required Block Vars
    max_batch_instance_percent   = "{{ windows_virtual_machine_scale_set.rolling_upgrade_policy.max_batch_instance_percent }}"
    max_unhealthy_instance_percent   = "{{ windows_virtual_machine_scale_set.rolling_upgrade_policy.max_unhealthy_instance_percent }}"
    max_unhealthy_upgraded_instance_percent   = "{{ windows_virtual_machine_scale_set.rolling_upgrade_policy.max_unhealthy_upgraded_instance_percent }}"
    pause_time_between_batches   = "{{ windows_virtual_machine_scale_set.rolling_upgrade_policy.pause_time_between_batches }}"
    ## Optional Block Vars
    cross_zone_upgrades_enabled   = {{ windows_virtual_machine_scale_set.rolling_upgrade_policy.cross_zone_upgrades_enabled }}
    prioritize_unhealth_instances_enabled   = {{ windows_virtual_machine_scale_set.rolling_upgrade_policy.prioritize_unhealth_instances_enabled }}
  }
  secret {
    ## Required Block Vars
    certificate {
      ## Required Block Vars
      store   = "{{ windows_virtual_machine_scale_set.secret.certificate.store }}"
      url   = "{{ windows_virtual_machine_scale_set.secret.certificate.url }}"
    }
    key_vault_id   = "{{ windows_virtual_machine_scale_set.secret.key_vault_id }}"
  }
  terminate_notification {
    ## Required Block Vars
    enabled   = {{ windows_virtual_machine_scale_set.terminate_notification.enabled }}
    ## Optional Block Vars
    timeout   = "{{ windows_virtual_machine_scale_set.terminate_notification.timeout }}"
  }
  termination_notification {
    ## Required Block Vars
    enabled   = {{ windows_virtual_machine_scale_set.termination_notification.enabled }}
    ## Optional Block Vars
    timeout   = "{{ windows_virtual_machine_scale_set.termination_notification.timeout }}"
  }
  winrm_listener {
    ## Required Block Vars
    protocol   = "{{ windows_virtual_machine_scale_set.winrm_listener.protocol }}"
    ## Optional Block Vars
    certificate_url   = "{{ windows_virtual_machine_scale_set.winrm_listener.certificate_url }}"
  }
  source_image_reference {
    ## Required Block Vars
    publisher   = "{{ windows_virtual_machine_scale_set.source_image_reference.publisher }}"
    offer   = "{{ windows_virtual_machine_scale_set.source_image_reference.offer }}"
    sku   = "{{ windows_virtual_machine_scale_set.source_image_reference.sku }}"
    version   = "{{ windows_virtual_machine_scale_set.source_image_reference.version }}"
  }
  spot_restore {
    ## Optional Block Vars
    enabled   = {{ windows_virtual_machine_scale_set.spot_restore.enabled }}
    timeout   = "{{ windows_virtual_machine_scale_set.spot_restore.timeout }}"
  }
}
